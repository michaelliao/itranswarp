# iTranswarp

Full-featured CMS including blog, wiki, discussion, etc. powered by SpringBoot.

[![Build Status](https://travis-ci.org/michaelliao/itranswarp.svg?branch=master)](https://travis-ci.org/michaelliao/itranswarp)

* based on SpringBoot 2.x
* OAuth2 integration (weibo, QQ, facebook, etc.)
* SEO support
* REST API
* customized css with uikit2

### Environment

- JDK 11
- MySQL 5.7
- Redis 4/5
- Nginx

### Build

```
$ mvn -DskipTests=true clean package
```

Or check [build.sh](build.sh).

### Initialize database

DDL and test data are generated by [SchemaBuilder.java](src/main/java/com/itranswarp/SchemaBuilder.java).

Create schema:

```
$ mysql -u root -p < release/ddl.sql
```

NOTE: re-run this SQL file will remove all existing data.

Import test data:

```
$ mysql -u root -p it < release/init.sql
```

### Run
 
```
java -jar itranswarp.jar
```

### Configuration

All configurations are passed by environments:

```
$ PROFILES=production TIME_ZONE=Asia/Shanghai DOMAIN=example.com \
  DB_HOST=localhost DB_PASSWORD=changeit \
  REDIS_HOST=localhost \
  java -jar itranswarp.jar
```

Please check [application.yml](src/main/resources/application.yml) for environment variables.

### Deploy

iTranswarp is deployed by Ansible. Scripts is ready for Ubuntu Server 18.04 x64 and CentOS7 x64

Deploy script:

For Ubuntu Server 18.04 x64
First you need to check the configuration in ansible/environments
```
$ ansible/deploy.py --profile <env>
```

For CentOS7 x64
First you need to check the configuration in ansible_CentOS7/environments
```
$ ansible_CentOS7/deploy.py --profile <env>
```

iTranswarp need MySQL 5.7 and Redis 4/5 to run, If you don't have, you can deploy by ansible.

Scripts is ready for CentOS7 x64

First you need to check the configuration in ansible_CentOS7_db/environments
```
$ ansible_CentOS7_db/deploy.py --profile <env>
```

The deploy script will do following:

- install open jdk 11 headless;
- install nginx;
- install supervisor;
- deploy jar;
- deploy static resources;
- generate nginx configuration;
- generate supervisor configuration;
- update symbol link;
- reload supervisor;
- reload nginx.



### Docker

Support [.env.example](docker/.env.example) use local ip for test. 
```
$ cd docker
$ cp .env.example
$ vim .env
$ docker-compose up -d
```
test:
https://www.local.itranswarp.com/

